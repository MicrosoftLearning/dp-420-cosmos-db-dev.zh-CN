---
lab:
  title: 通过 Azure 门户为 Azure Cosmos DB for NoSQL 配置吞吐量
  module: Module 2 - Plan and implement Azure Cosmos DB for NoSQL
---

# 通过 Azure 门户为 Azure Cosmos DB for NoSQL 配置吞吐量

配置 Azure Cosmos DB for NoSQL 吞吐量是最重要的事情之一。 为了创建 Azure Cosmos DB for NoSQL 容器，必须首先创建一个帐户，然后创建一个数据库，按顺序进行。

在本实验室中，你将在数据资源管理器中使用各种方法预配吞吐量。 你将通过手动方式或使用自动缩放在数据库和容器级别预配吞吐量。

## 创建无服务器帐户

首先，我们创建一个无服务器帐户。 这一步没有太多的配置，因为所有内容都是无服务器的。 在创建数据库和容器时，根本无需预配吞吐量。 你将在创建此帐户时看到所有这些操作。

1. 在新的 Web 浏览器窗口或选项卡中，导航到 Azure 门户 (``portal.azure.com``)。

1. 使用与你的订阅关联的 Microsoft 凭据登录到门户。

1. 在“Azure 服务”类别中，选择“创建资源”，然后选择“Azure Cosmos DB”。

    > &#128161; 或者，展开“&#8801;”菜单，选择“所有服务”，在“数据库”类别中选择“Azure Cosmos DB”，然后选择“创建”。

1. 在“选择 API 选项”窗格中，选择“Azure Cosmos DB for NoSQL”部分中的“创建”选项。

1. 在“创建 Azure Cosmos DB 帐户”窗格内，查看“基本信息”选项卡。

1. 在“基本信息”选项卡上，为每个设置输入以下值：

    | **设置** | 值 |
    | --: | :-- |
    | **订阅** | **使用现有 Azure 订阅。** *所有资源都必须属于某个资源组。每个资源组都必须属于某个订阅。* |
    | **资源组** | **使用现有的资源组或者新建资源组。** *所有资源都必须属于某个资源组。*|
    | **Account Name** |  **输入任何全局唯一名称。** *全局唯一的帐户名称。此名称将用作请求的 DNS 地址的一部分。门户将实时检查该名称。* |
    | **位置** | **选择任何可用区域。** *选择最初托管数据库的地理区域。* |
    | **容量模式** | 选择“无服务器” |

1. 依次选择“审阅并创建”以导航到“审阅并创建”选项卡，然后选择“创建”。

    > &#128221; Azure Cosmos DB for NoSQL 帐户可能需要 10-15 分钟才能可供使用。

1. 观察“部署”窗格。 部署完成后，窗格将更新，显示“部署成功”消息。

1. 仍然是在“部署”窗格中，选择“转到资源” 。

1. 从“Azure Cosmos DB 帐户”窗格内，选择资源菜单中的“数据资源管理器”。

1. 在“数据资源管理器”窗格中，展开“新建容器”，然后选择“新建数据库”。

1. 在“新建数据库”弹出窗口中，为每个设置输入以下值，然后选择“确定”：

    | **设置** | **值** |
    | --: | :-- |
    | **数据库 ID** | *`cosmicworks`* |

1. 返回到“数据资源管理器”窗格，观察层次结构中的“cosmicworks”数据库节点。

1. 在“数据资源管理器”窗格中，选择“新建容器” 。

1. 在“新建容器”弹出窗口中，为每个设置输入以下值，然后选择“确定” ：

    | **设置** | **值** |
    | --: | :-- |
    | **数据库 ID** | 使用现有 &vert; cosmicworks |
    | **容器 ID** | *`products`* |
    | **分区键** | *`/categoryId`* |

1. 返回到“数据资源管理器”窗格中，展开“cosmicworks”数据库节点，然后观察层次结构中的“products”容器节点。

1. 转到 Azure 门户的主页。

## 创建预配的帐户

现在，我们将使用更传统的配置选项创建预配的吞吐量帐户。 这种类型的帐户将为我们打开一个配置选项的世界，这可能有点令人不知所措。 我们将在这里演练几个可能的数据库和容器配对示例。

1. 在“Azure 服务”类别中，选择“创建资源”，然后选择“Azure Cosmos DB”。

    > &#128161; 或者，展开“&#8801;”菜单，选择“所有服务”，在“数据库”类别中选择“Azure Cosmos DB”，然后选择“创建”。

1. 在“选择 API 选项”窗格中，选择“Azure Cosmos DB for NoSQL”部分中的“创建”选项。

1. 在“创建 Azure Cosmos DB 帐户”窗格内，查看“基本信息”选项卡。

1. 在“基本信息”选项卡上，为每个设置输入以下值：

    | **设置** | 值 |
    | --: | :-- |
    | **订阅** | **使用现有 Azure 订阅。** *所有资源都必须属于某个资源组。每个资源组都必须属于某个订阅。* |
    | **资源组** | **使用现有的资源组或者新建资源组。** *所有资源都必须属于某个资源组。*|
    | **Account Name** |  **输入任何全局唯一名称。** *全局唯一的帐户名称。此名称将用作请求的 DNS 地址的一部分。门户将实时检查该名称。* |
    | **位置** | **选择任何可用区域。** *选择最初托管数据库的地理区域。* |
    | **容量模式** | **预配的吞吐量** |
    | **应用免费分级折扣** | **不应用** |
    | 限制可在此帐户上预配的总吞吐量 | **未选中** |

1. 依次选择“审阅并创建”以导航到“审阅并创建”选项卡，然后选择“创建”。

    > &#128221; Azure Cosmos DB for NoSQL 帐户可能需要 10-15 分钟才能可供使用。

1. 观察“部署”窗格。 部署完成后，窗格将更新，显示“部署成功”消息。

1. 仍然是在“部署”窗格中，选择“转到资源” 。

1. 从“Azure Cosmos DB 帐户”窗格内，选择资源菜单中的“数据资源管理器”。

1. 在“数据资源管理器”窗格中，展开“新建容器”，然后选择“新建数据库”。

1. 在“新建数据库”弹出窗口中，为每个设置输入以下值，然后选择“确定”：

    | **设置** | **值** |
    | --: | :-- |
    | **数据库 ID** | *`nothroughputdb`* |
    | 预配吞吐量 | *未选中* |

1. 返回“数据资源管理器”窗格中，观察层次结构中的“nothroughputdb”数据库节点。

1. 在“数据资源管理器”窗格中，选择“新建容器” 。

1. 在“新建容器”弹出窗口中，为每个设置输入以下值，然后选择“确定” ：

    | **设置** | **值** |
    | --: | :-- |
    | **数据库 ID** | 使用现有 &vert; nothroughputdb |
    | **容器 ID** | *`requiredthroughputcontainer`* |
    | **分区键** | *`/primarykey`* |
    | **容器吞吐量** | *手动* |
    | **RU/秒** | *`400`* |

1. 返回到“数据资源管理器”窗格，展开“nothroughputdb”数据库节点，然后观察层次结构中的“requiredthroughputcontainer”容器节点。

1. 在“数据资源管理器”窗格中，展开“新建容器”，然后选择“新建数据库”。

1. 在“新建数据库”弹出窗口中，为每个设置输入以下值，然后选择“确定”：

    | **设置** | **值** |
    | --: | :-- |
    | **数据库 ID** | *`manualthroughputdb`* |
    | 预配吞吐量 | *已选中* |
    | **数据库吞吐量** | *手动* |
    | **RU/秒** | *`400`* |

1. 返回到“数据资源管理器”窗格，观察层次结构中的“manualthroughputdb”数据库节点。

1. 在“数据资源管理器”窗格中，选择“新建容器” 。

1. 在“新建容器”弹出窗口中，为每个设置输入以下值，然后选择“确定” ：

    | **设置** | **值** |
    | --: | :-- |
    | **数据库 ID** | 使用现有 &vert; manualthroughputdb |
    | **容器 ID** | *`childcontainer`* |
    | **分区键** | *`/primarykey`* |
    | 为此容器预配专用吞吐量 | *已选中* |
    | **容器吞吐量** | *手动* |
    | **RU/秒** | *`1000`* |

1. 返回到“数据资源管理器”窗格，展开“manualthroughputdb”数据库节点，然后观察层次结构中的“childcontainer”容器节点。
